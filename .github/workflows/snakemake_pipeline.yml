name: GitHub Actions Demo
run-name: ${{ github.actor }} is testing out GitHub Actions üöÄ
on: [push]
jobs:
  Explore-GitHub-Actions:
    runs-on: ubuntu-latest
    steps:
      - run: echo "üéâ The job was automatically triggered by a ${{ github.event_name }} event."
      - run: echo "üêß This job is now running on a ${{ runner.os }} server hosted by GitHub!"
      - run: echo "üîé The name of your branch is ${{ github.ref }} and your repository is ${{ github.repository }}."
      - name: Check out repository code
        uses: actions/checkout@v3
      - run: echo "üí° The ${{ github.repository }} repository has been cloned to the runner."
      - run: echo "üñ•Ô∏è The workflow is now ready to test your code on the runner."
      - name: List files in the repository
        run: |
          ls ${{ github.workspace }}
      - name: Chromosome 3 workflow
        run: |
          cat config.yaml
      - name: Running Chr3 workflow
        uses: snakemake/snakemake-github-action@v1
        with:
          directory: '.'
          snakefile: 'Snakefile'
          args: '--cores 1 --use-conda download_data data/original_bam/filtering/ERR696683_chr3_sorted.bam data/reference/genome.fa results/fastqc_result/ERR696683_chr3_1_fastqc.html results/fastqc_result/ERR7533{68..78}_chr3_1_fastqc.html data/processed/ERR696683_chr3_1_fastp.fastq.gz data/processed/ERR7533{68..78}_chr3_1_fastp.fastq.gz results/fastqc_result/trimmed/ERR696683_chr3_1_fastp_fastqc.html results/fastqc_result/trimmed/ERR7533{68..78}_chr3_1_fastp_fastqc.html results/mapped_reads/ERR696683_chr3_sorted.sam results/mapped_reads/ERR7533{68..78}_chr3_sorted.sam results/mapped_reads/bam_files/ERR696683_chr3_sorted.bam results/mapped_reads/bam_files/ERR7533{68..78}_chr3_sorted.bam results/mapped_reads/bam_files/ERR696683_chr3_dedup.bam results/mapped_reads/bam_files/ERR7533{68..78}_chr3_dedup.bam results/variants/ERR696683_chr3.vcf results/variants/ERR7533{68..78}_chr3.vcf vep_install_db results/variants/vep/ERR696683_chr3.txt results/variants/vep/ERR7533{68..78}_chr3.txt parsing_dataR'
          stagein: '' # additional preliminary commands to run (can be multiline)
      - name: chromosome 5 workflow
        run: |
          sed -i '6,+12s/chr3/chr5/g' config.yaml
          sed -i '24,+12s/chr3/chr5/g' config.yaml
          sed -i '39s/chr3/chr5/g' config.yaml
          sed -i '46s/chromosome.3.fa.gz/chromosome.5.fa.gz/g' config.yaml
          sed -i '65s/PIK3CA/APC/g' config.yaml
          cat config.yaml
      - name: Running Chr5 workflow
        uses: snakemake/snakemake-github-action@v1
        with:
          directory: '.'
          snakefile: 'Snakefile'
          args: '--cores 1 --use-conda --force data/original_bam/filtering/ERR696683_chr5_sorted.bam data/reference/genome.fa results/fastqc_result/ERR696683_chr5_1_fastqc.html results/fastqc_result/ERR7533{68..78}_chr5_1_fastqc.html data/processed/ERR696683_chr5_1_fastp.fastq.gz data/processed/ERR7533{68..78}_chr5_1_fastp.fastq.gz results/fastqc_result/trimmed/ERR696683_chr5_1_fastp_fastqc.html results/fastqc_result/trimmed/ERR7533{68..78}_chr5_1_fastp_fastqc.html results/mapped_reads/ERR696683_chr5_sorted.sam results/mapped_reads/ERR7533{68..78}_chr5_sorted.sam results/mapped_reads/bam_files/ERR696683_chr5_sorted.bam results/mapped_reads/bam_files/ERR7533{68..78}_chr5_sorted.bam results/mapped_reads/bam_files/ERR696683_chr5_dedup.bam results/mapped_reads/bam_files/ERR7533{68..78}_chr5_dedup.bam results/variants/ERR696683_chr5.vcf results/variants/ERR7533{68..78}_chr5.vcf results/variants/vep/ERR696683_chr5.txt results/variants/vep/ERR7533{68..78}_chr5.txt parsing_dataR'
          stagein: '' # additional preliminary commands to run (can be multiline)
      - name: chromosome 7 workflow
        run: |
          sed -i '6,+12s/chr5/chr7/g' config.yaml
          sed -i '24,+12s/chr5/chr7/g' config.yaml
          sed -i '39s/chr5/chr7/g' config.yaml
          sed -i '46s/chromosome.5.fa.gz/chromosome.7.fa.gz/g' config.yaml
          sed -i '65s/APC/BRAF/g' config.yaml
          cat config.yaml
      - name: Running Chr7 workflow
        uses: snakemake/snakemake-github-action@v1
        with:
          directory: '.'
          snakefile: 'Snakefile'
          args: '--cores 1 --use-conda --force data/original_bam/filtering/ERR696683_chr7_sorted.bam data/reference/genome.fa results/fastqc_result/ERR696683_chr7_1_fastqc.html results/fastqc_result/ERR7533{68..78}_chr7_1_fastqc.html data/processed/ERR696683_chr7_1_fastp.fastq.gz data/processed/ERR7533{68..78}_chr7_1_fastp.fastq.gz results/fastqc_result/trimmed/ERR696683_chr7_1_fastp_fastqc.html results/fastqc_result/trimmed/ERR7533{68..78}_chr7_1_fastp_fastqc.html results/mapped_reads/ERR696683_chr7_sorted.sam results/mapped_reads/ERR7533{68..78}_chr7_sorted.sam results/mapped_reads/bam_files/ERR696683_chr7_sorted.bam results/mapped_reads/bam_files/ERR7533{68..78}_chr7_sorted.bam results/mapped_reads/bam_files/ERR696683_chr7_dedup.bam results/mapped_reads/bam_files/ERR7533{68..78}_chr7_dedup.bam results/variants/ERR696683_chr7.vcf results/variants/ERR7533{68..78}_chr7.vcf results/variants/vep/ERR696683_chr7.txt results/variants/vep/ERR7533{68..78}_chr7.txt parsing_dataR'
          stagein: '' # additional preliminary commands to run (can be multiline)          
      - name: chromosome 12 workflow
        run: |
          sed -i '6,+12s/chr7/chr12/g' config.yaml
          sed -i '24,+12s/chr7/chr12/g' config.yaml
          sed -i '39s/chr7/chr12/g' config.yaml
          sed -i '46s/chromosome.7.fa.gz/chromosome.12.fa.gz/g' config.yaml
          sed -i '65s/BRAF/KRAS/g' config.yaml
          cat config.yaml
      - name: Running Chr12 workflow
        uses: snakemake/snakemake-github-action@v1
        with:
          directory: '.'
          snakefile: 'Snakefile'
          args: '--cores 1 --use-conda --force data/original_bam/filtering/ERR696683_chr12_sorted.bam data/reference/genome.fa results/fastqc_result/ERR696683_chr12_1_fastqc.html results/fastqc_result/ERR7533{68..78}_chr12_1_fastqc.html data/processed/ERR696683_chr12_1_fastp.fastq.gz data/processed/ERR7533{68..78}_chr12_1_fastp.fastq.gz results/fastqc_result/trimmed/ERR696683_chr12_1_fastp_fastqc.html results/fastqc_result/trimmed/ERR7533{68..78}_chr12_1_fastp_fastqc.html results/mapped_reads/ERR696683_chr12_sorted.sam results/mapped_reads/ERR7533{68..78}_chr12_sorted.sam results/mapped_reads/bam_files/ERR696683_chr12_sorted.bam results/mapped_reads/bam_files/ERR7533{68..78}_chr12_sorted.bam results/mapped_reads/bam_files/ERR696683_chr12_dedup.bam results/mapped_reads/bam_files/ERR7533{68..78}_chr12_dedup.bam results/variants/ERR696683_chr12.vcf results/variants/ERR7533{68..78}_chr12.vcf results/variants/vep/ERR696683_chr12.txt results/variants/vep/ERR7533{68..78}_chr12.txt parsing_dataR'
          stagein: '' # additional preliminary commands to run (can be multiline)   
      - name: chromosome 17 workflow
        run: |
          sed -i '6,+12s/chr12/chr17/g' config.yaml
          sed -i '24,+12s/chr12/chr17/g' config.yaml
          sed -i '39s/chr12/chr17/g' config.yaml
          sed -i '46s/chromosome.12.fa.gz/chromosome.17.fa.gz/g' config.yaml
          sed -i '65s/KRAS/TP53/g' config.yaml
          cat config.yaml
      - name: Running Chr17 workflow
        uses: snakemake/snakemake-github-action@v1
        with:
          directory: '.'
          snakefile: 'Snakefile'
          args: '--cores 1 --use-conda --force data/original_bam/filtering/ERR696683_chr17_sorted.bam data/reference/genome.fa results/fastqc_result/ERR696683_chr17_1_fastqc.html results/fastqc_result/ERR7533{68..78}_chr17_1_fastqc.html data/processed/ERR696683_chr17_1_fastp.fastq.gz data/processed/ERR7533{68..78}_chr17_1_fastp.fastq.gz results/fastqc_result/trimmed/ERR696683_chr17_1_fastp_fastqc.html results/fastqc_result/trimmed/ERR7533{68..78}_chr17_1_fastp_fastqc.html results/mapped_reads/ERR696683_chr17_sorted.sam results/mapped_reads/ERR7533{68..78}_chr17_sorted.sam results/mapped_reads/bam_files/ERR696683_chr17_sorted.bam results/mapped_reads/bam_files/ERR7533{68..78}_chr17_sorted.bam results/mapped_reads/bam_files/ERR696683_chr17_dedup.bam results/mapped_reads/bam_files/ERR7533{68..78}_chr17_dedup.bam results/variants/ERR696683_chr17.vcf results/variants/ERR7533{68..78}_chr17.vcf results/variants/vep/ERR696683_chr17.txt results/variants/vep/ERR7533{68..78}_chr17.txt parsing_dataR'
          stagein: '' # additional preliminary commands to run (can be multiline) 
      - name: Reset config.yaml
        run: |
          sed -i '6,+12s/chr17/chr3/g' config.yaml
          sed -i '24,+12s/chr17/chr3/g' config.yaml
          sed -i '39s/chr5/chr3/g' config.yaml
          sed -i '46s/chromosome.17.fa.gz/chromosome.3.fa.gz/g' config.yaml
          sed -i '65s/TP53/PIK3CA/g' config.yaml
      - name: Check results
        run: |
          ls results/biostatistics/plots/
          ls results/objective/
      - run: echo "üçè This job's status is ${{ job.status }}."
